# 单调栈与单调队列

## 单调栈

单调栈可以线性解决一个序列中“以某个值为最值的最大区间”等问题。

> 给定长度为 $n$ 的序列 $\{h_n\}$，求出 $\{f_n\}$，$f_i$ 表示从 $i$ 开始第一个大于 $h_i$ 的数的下标（没有则 0）。

```cpp
int n, h[N], f[N];
void solve() {
    memset(f, 0, sizeof(f));
    stack<int> s;
    for (int i = 1; i <= n; ++i) {
        while (!s.empty() && h[s.top()] < h[i]) {
            int x = s.top(); s.pop();
            f[x] = i;
        }
        s.push(i);
    }
}
```



## 单调队列

单调队列可以用来解决区间最值类问题，例如著名的**滑动窗口**：

> 给定长度为 $n$ 的序列 $\{a_n\}$ 和正整数 $k$。要求分别求出 $f(1),f(2),\cdots,f(n-k+1)$，其中 $f(x)$ 表示区间 $[x,x+k-1]$ 上的最大值。

```cpp
int n, k, a[N], f[N];
void solve() {
    deque<int> q;
    for (int i = 1; i <= n; ++i) {
        while (!q.empty() && q.front() < i - k + 1) q.pop_front();
        while (!q.empty() && a[q.back()] <= a[i]) q.pop_back();
        q.push_back(i);
        if (i >= k) f[i - k + 1] = a[q.front()];
    }
}
```

